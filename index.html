<!DOCTYPE html>
<html>
  <head>
    <title>Excel Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="./body.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./bootstrap.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xls/0.7.4-a/xls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/read-excel-file@4.1.0/bundle/read-excel-file.min.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Converter Tools</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarColor03">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="https://ianbedard.github.io/WordConverter/">docx | html
              
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="https://ianbedard.github.io/ExcelConverter/">xlsx | json</a>  
              <span class="visually-hidden">(current)</span>
            </li>
  
          </ul>
    
        </div>
      </div>
    </nav>
    <div class="container">
      <div id="title">
        <div class="col-md-10">
          <h1>Excel to Json</h1>
         
        </div>
      </div>

      <div class="form-group row">
    
      
       
        <div class="buttons">
              <input class="form-control" type="file" id="input" />

        </div>

        <div class="col-md-12">
          <label for="textOrigin" class="form-label mt-4">Upload :</label>
          <textarea
          rows="20"
            class="form-control"
            type="text"
            id="json-data"
            name="json-data"
            value="textOrigin"
            placeholder="Json will appear here"
          ></textarea>
        </div>
         <button type="button" id="dl-json" class="btn btn-primary">
            Copy Text
          </button>
      </div>

    </div>
<script>
  const input = $('#input')[0];
 // gets the data from the input form
  input.addEventListener('change', ()=>{
    readXlsxFile(input.files[0]).then((data)=>{
      let i = 0;
      let headers = []
      let json_object = []

      data.map((row, index)=>{
          if(i==0){
            headers = row;
          }
        if (i > 0) {
let temp ={};
for(let x = 0; x < row.length; x++){
temp[headers[x]] = row[x];
}
json_object.push(temp);
        }
i++;

      });
     
  $('#json-data')[0].value = JSON.stringify(json_object, null, 2)
  
    });
  })
 

$('#dl-json')[0].onclick = ()=>{ navigator.clipboard.writeText($('#json-data')[0].value)}

</script>
   
  </body>
</html>
